<!doctype html><html lang="es"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Reportes - Biblioteca IESADEP</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="styles.css" rel="stylesheet"></head><body>
<div class="container py-4">
  <a href="index.html" class="btn btn-link">&larr; Volver</a>
  <h2>Reportes</h2>
  <p>Generar PDF mensual</p>
  <div class="d-flex gap-2">
    <input id="month" type="month" class="form-control w-auto">
    <button id="gen" class="btn btn-primary">Generar PDF</button>
  </div>
  <div id="report-link" class="mt-3"></div>
</div>
<script src="common.js"></script>
<script>
document.getElementById('gen').onclick = async ()=>{
  const m = document.getElementById('month').value;
  if(!m) { alert('Seleccione mes'); return; }
  const res = await fetch('/api/reports/monthly?month='+encodeURIComponent(m), {headers: API.authHeaders()});
  if(!res.ok) { alert('Error generando'); return; }
  const blob = await res.blob();
  const url = URL.createObjectURL(blob);
  document.getElementById('report-link').innerHTML = '<a href="'+url+'" target="_blank" class="btn btn-success">Abrir PDF</a>';
};
</script>
</body></html>